{% extends "base.html" %}

{% block title %}Browse Stores - Smart QR Shopping{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>Browse Stores</h1>
        <p>Welcome, <strong>{{ session.email }}</strong>! Discover amazing products.</p>
        <button onclick="openScanner()" class="btn-scanner">üì∑ Scan QR Code</button>
        <button onclick="manualEnterCode()" class="btn-secondary"
            style="margin-left: 10px; padding: 10px 20px; border-radius: 25px;">‚å®Ô∏è Enter Code</button>
    </div>

    <div id="stores-grid" class="grid">
        <!-- Stores will be loaded here dynamically -->
    </div>

    <div id="no-stores" class="empty-state" style="display: none;">
        <h3>No stores available yet</h3>
        <p>Check back soon for new stores!</p>
    </div>
</div>

<!-- QR Scanner Modal -->
<div id="scanner-modal" class="scanner-modal">
    <div class="scanner-container">
        <div class="scanner-header">
            <h2>Scan QR Code</h2>
            <button onclick="closeScanner()" class="btn-close">‚úï</button>
        </div>
        <div id="qr-reader"></div>
        <div class="scanner-instructions">
            <p>Point your camera at a product QR code</p>
            <div style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 15px;">
                <p style="font-size: 0.9em; margin-bottom: 5px;">Or upload an image:</p>
                <input type="file" id="qr-input-file" accept="image/*" onchange="scanFromFile(this)">
            </div>
        </div>
    </div>
</div>

<!-- Product Detail Modal -->
<div id="product-modal" class="scanner-modal" style="display: none; align-items: center; justify-content: center;">
    <div class="scanner-container" style="max-width: 500px; width: 90%;">
        <div class="scanner-header">
            <h2>Product Details</h2>
            <button onclick="closeProductModal()" class="btn-close">‚úï</button>
        </div>
        <div id="modal-product-content" style="padding: 20px; text-align: center;">
            <!-- Product details injected here -->
            <div class="loading-spinner">Loading...</div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
<script src="{{ url_for('static', filename='js/customer.js') }}?v=9"></script>
{% endblock %}